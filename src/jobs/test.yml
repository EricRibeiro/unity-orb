description: >
  Simple drop-in job to run tests for your Unity game.

parameters:
  tag:
    default: 2021.2.7f1-mac-mono-0.15
    description: >
      Pick a specific unityci/editor image variant:
      https://hub.docker.com/r/unityci/editor/tags
    type: string
  test-platform:
    type: string
    default: "PlayMode"
  license:
    type: env_var_name
    default: "ENCODED_ULF_LICENSE"
    description: |
      Enter the name of the environment variable containing Unity's ULF license activation file encoded in base64.
      For more information on how to get such file and encoded it, access the wiki page: TODO create and add wiki page.
  verbose:
    type: boolean
    default: false
    description: |
      If set to "true", all the outputs from the Unity CLI commands will be redirected to stdout.

docker:
  - image: 'unityci/editor:<<parameters.tag>>'

steps:
  - checkout
  - activate:
      license: <<parameters.license>>
      verbose: <<parameters.verbose>>
  - run-tests:
      test-platform: <<parameters.test-platform>>
      verbose: <<parameters.verbose>>
  # TODO: change to store_test
  - store_artifacts: 
      path: results.xml